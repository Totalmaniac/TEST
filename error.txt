$pwd_1 = "Computerworld123456!"
$pws_2 = ConvertTo-SecureString $pwd_1 -AsPlainText -Force

$sendmbox = "noman.khan@wearejust.o.uk"

$receivembox = "noman.khan@wearejust.co.uk"

$body = "this is a test email"

$props = @{
    
SMTPServer = "smtp.office365.com"

From = $sendmbox
To = $receivembox
Subject = "test"
UserSSL = $true 
port = 587
Credential = New-Object System.Management.Automation.PSCredential($sendmbox,$pwd_2)
}

Send-MailMessage @props $body  
-------------------------------------

PS /home/noman> $pwd_1 = "Computerworld123456!"
PS /home/noman> $pws_2 = ConvertTo-SecureString $pwd_1 -AsPlainText -Force
PS /home/noman> 
PS /home/noman> $sendmbox = "noman.khan@wearejust.o.uk"
PS /home/noman> 
PS /home/noman> $receivembox = "noman.khan@wearejust.co.uk"
PS /home/noman> 
PS /home/noman> $body = "this is a test email"
PS /home/noman> 
PS /home/noman> $props = @{
>>     
>> SMTPServer = "smtp.office365.com"
>> 
>> From = $sendmbox
>> To = $receivembox
>> Subject = "test"
>> UserSSL = $true 
>> port = 587
>> Credential = New-Object System.Management.Automation.PSCredential($sendmbox,$pwd_2)
>> }
New-Object: 
Line |
  10 |  … redential = New-Object System.Management.Automation.PSCredential($sen …
     |                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | Exception calling ".ctor" with "2" argument(s): "Cannot process argument because the value of argument "password" is null. Change the value of argument "password" to a non-null value."
PS /home/noman> 
PS /home/noman> Send-MailMessage @props $body  
Send-MailMessage: Cannot validate argument on parameter 'To'. The argument is null or empty. Provide an argument that is not null or empty, and then try the command again.

_--------------------




$securePassword = ConvertTo-SecureString "Computerworld123456!" -AsPlainText -Force

$sendmbox = "noman.khan@wearejust.o.uk"  
$receivembox = "noman.khan@wearejust.co.uk"

$cred = New-Object System.Management.Automation.PSCredential ($sendmbox, $securePassword)

$props = @{
  SMTPServer = "smtp.office365.com"
  From = $sendmbox 
  To = $receivembox
  Subject = "test"
  UserSSL = $true
  port = 587  
  Credential = $cred
}

$body = "this is a test email"

Send-MailMessage @props $body

_----------------------

WARNING: The command 'Send-MailMessage' is obsolete. This cmdlet does not guarantee secure connections to SMTP servers. While there is no immediate replacement available in PowerShell, we recommend you do not use Send-MailMessage at this time. See https://aka.ms/SendMailMessage for more information.
Send-MailMessage: Error in processing. The server response was: 5.7.3 STARTTLS is required to send mail [AS4P191CA0018.EURP191.PROD.OUTLOOK.COM 2023-12-22T12:37:57.388Z 08DC02A8D047AE0E]
